Literally just a port of http://arxiv.org/abs/1503.04085. All credit goes to Navid Dianati.
